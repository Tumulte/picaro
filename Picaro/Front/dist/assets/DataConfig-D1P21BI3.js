import{d as F,p as B,h as x,r as g,i as u,q as L,j as m,k as f,F as T,l as U,a as c,w as i,f as S,c as w,A as p,b as R,L as j,v as q,u as z,z as D,o as s,n as P,s as O,t as G,e as v}from"./index-WjlegVn6.js";import{V as H,a as k}from"./VTabs-C5KaWdSy.js";const J={class:"pic-flex"},K={class:"pic-aside pic-container"},Q=f("h3",null," Model List ",-1),W=["onClick"],X={class:"pic-main pic-container"},Y={key:1,class:"pic-new-model"},oe=F({__name:"DataConfig",emits:["reloadSettings"],setup(Z){const l=B(),_=x(),C=z(),t=D(),a=g("noModel"),d=g(),n=g(""),M=u(()=>{var e;return((e=l.currentAppSettings)==null?void 0:e.modelCollection)||[]}),I=u(()=>{var e;return((e=d.value)==null?void 0:e.name)||""}),N=u(()=>Object.keys(M).filter(e=>e===n.value).length===0);function $(e){l.currentAppSettings?C.push({path:`/admin/data/${l.currentAppSettings.id}/${e.id}`}):_.addAlert({text:"Please select an app first",type:"warning"})}const A=u(()=>{var e;return((e=l.currentAppSettings)==null?void 0:e.modelCollection)||[]});function V(){a.value="modelCreated",n.value=n.value.toLowerCase(),d.value={id:j(8),name:n.value,fieldCollection:[]}}function y(){a.value="noModel",d.value=void 0,n.value="",l.currentAppSettings?C.push({path:`/data/${l.currentAppSettings.id}`}):_.addAlert({text:"Please select an app first",type:"warning"})}function h(){t!=null&&t.params.modelId&&l.currentAppSettings&&(t==null?void 0:t.params.modelId)!=="newModel"&&(d.value=l.currentAppSettings.modelCollection.find(e=>e.id===t.params.modelId),a.value="modelCreated")}function b(){C.replace({name:"model",params:{appId:t.params.appId,modelId:"newModel"}}),a.value="awaitingName"}return L(()=>t.params.modelId,e=>{e&&h()},{immediate:!0}),(e,r)=>{const E=q("router-view");return s(),m("div",J,[f("aside",K,[Q,(s(!0),m(T,null,U(A.value,o=>(s(),m("div",{key:o.id,class:"current-model-elements"},[f("a",{class:P(["pic-aside-item",{selected:o.id===O(t).params.modelId}]),onClick:ee=>$(o)},G(o.name),11,W)]))),128)),c(S,{color:"primary","data-test":"new-model-button",onClick:b},{default:i(()=>[v(" New Model ")]),_:1})]),f("main",X,[a.value!=="noModel"&&a.value!=="awaitingName"?(s(),w(H,{key:0},{default:i(()=>[c(k,{to:`/admin/data/${e.$route.params.appId}/${e.$route.params.modelId}/`},{default:i(()=>[v(" Edit Model ")]),_:1},8,["to"]),c(k,{to:`/admin/data/${e.$route.params.appId}/${e.$route.params.modelId}/content`},{default:i(()=>[v(" Edit content ")]),_:1},8,["to"])]),_:1})):p("",!0),a.value==="awaitingName"?(s(),m("div",Y,[c(R,{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=o=>n.value=o),"data-test":"create-model-name-input",label:"New model name"},null,8,["modelValue"]),I.value?p("",!0):(s(),w(S,{key:0,"data-test":"create-model-button",color:"primary",disabled:!n.value||!N.value,onClick:V},{default:i(()=>[v(" Create model ")]),_:1},8,["disabled"]))])):p("",!0),d.value?(s(),w(E,{key:2,class:"mt-4","current-edit-model":d.value,"model-form-state":a.value,"model-collection":M.value,onUpdateModelFormState:r[1]||(r[1]=o=>a.value=o),onCancelEditModel:r[2]||(r[2]=o=>y())},null,8,["current-edit-model","model-form-state","model-collection"])):p("",!0)])])}}});export{oe as default};
