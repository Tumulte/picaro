(self.webpackChunkjavascript_development_environment=self.webpackChunkjavascript_development_environment||[]).push([[652],{1081:(t,e,r)=>{"use strict";r.d(e,{vs:()=>a,FC:()=>y,Pu:()=>v,wx:()=>c,Mn:()=>b,Ax:()=>C,nj:()=>x,nd:()=>S,k9:()=>k});var n=r(3263),o=Math.pow(2,16);function i(t){return 65535&t}var p=function(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=null),this.pos=t,this.deleted=e,this.recover=r},s=function(t,e){void 0===e&&(e=!1),this.ranges=t,this.inverted=e};s.prototype.recover=function(t){var e=0,r=i(t);if(!this.inverted)for(var n=0;n<r;n++)e+=this.ranges[3*n+2]-this.ranges[3*n+1];return this.ranges[3*r]+e+function(t){return(t-(65535&t))/o}(t)},s.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},s.prototype.map=function(t,e){return void 0===e&&(e=1),this._map(t,e,!0)},s.prototype._map=function(t,e,r){for(var n=0,i=this.inverted?2:1,s=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var h=this.ranges[a]-(this.inverted?n:0);if(h>t)break;var c=this.ranges[a+i],f=this.ranges[a+s],u=h+c;if(t<=u){var l=h+n+((c?t==h?-1:t==u?1:e:e)<0?0:f);return r?l:new p(l,e<0?t!=h:t!=u,t==(e<0?h:u)?null:a/3+(t-h)*o)}n+=f-c}return r?t+n:new p(t+n)},s.prototype.touches=function(t,e){for(var r=0,n=i(e),o=this.inverted?2:1,p=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?r:0);if(a>t)break;var h=this.ranges[s+o];if(t<=a+h&&s==3*n)return!0;r+=this.ranges[s+p]-h}return!1},s.prototype.forEach=function(t){for(var e=this.inverted?2:1,r=this.inverted?1:2,n=0,o=0;n<this.ranges.length;n+=3){var i=this.ranges[n],p=i-(this.inverted?o:0),s=i+(this.inverted?0:o),a=this.ranges[n+e],h=this.ranges[n+r];t(p,p+a,s,s+h),o+=h-a}},s.prototype.invert=function(){return new s(this.ranges,!this.inverted)},s.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},s.offset=function(t){return 0==t?s.empty:new s(t<0?[0,-t,0]:[0,0,t])},s.empty=new s([]);var a=function(t,e,r,n){this.maps=t||[],this.from=r||0,this.to=null==n?this.maps.length:n,this.mirror=e};function h(t){var e=Error.call(this,t);return e.__proto__=h.prototype,e}a.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.maps.length),new a(this.maps,this.mirror,t,e)},a.prototype.copy=function(){return new a(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},a.prototype.appendMap=function(t,e){this.to=this.maps.push(t),null!=e&&this.setMirror(this.maps.length-1,e)},a.prototype.appendMapping=function(t){for(var e=0,r=this.maps.length;e<t.maps.length;e++){var n=t.getMirror(e);this.appendMap(t.maps[e],null!=n&&n<e?r+n:null)}},a.prototype.getMirror=function(t){if(this.mirror)for(var e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]},a.prototype.setMirror=function(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)},a.prototype.appendMappingInverted=function(t){for(var e=t.maps.length-1,r=this.maps.length+t.maps.length;e>=0;e--){var n=t.getMirror(e);this.appendMap(t.maps[e].invert(),null!=n&&n>e?r-n-1:null)}},a.prototype.invert=function(){var t=new a;return t.appendMappingInverted(this),t},a.prototype.map=function(t,e){if(void 0===e&&(e=1),this.mirror)return this._map(t,e,!0);for(var r=this.from;r<this.to;r++)t=this.maps[r].map(t,e);return t},a.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},a.prototype._map=function(t,e,r){for(var n=!1,o=this.from;o<this.to;o++){var i=this.maps[o].mapResult(t,e);if(null!=i.recover){var s=this.getMirror(o);if(null!=s&&s>o&&s<this.to){o=s,t=this.maps[s].recover(i.recover);continue}}i.deleted&&(n=!0),t=i.pos}return r?t:new p(t,n)},h.prototype=Object.create(Error.prototype),h.prototype.constructor=h,h.prototype.name="TransformError";var c=function(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new a},f={before:{configurable:!0},docChanged:{configurable:!0}};function u(){throw new Error("Override me")}f.before.get=function(){return this.docs.length?this.docs[0]:this.doc},c.prototype.step=function(t){var e=this.maybeStep(t);if(e.failed)throw new h(e.failed);return this},c.prototype.maybeStep=function(t){var e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e},f.docChanged.get=function(){return this.steps.length>0},c.prototype.addStep=function(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e},Object.defineProperties(c.prototype,f);var l=Object.create(null),d=function(){};d.prototype.apply=function(t){return u()},d.prototype.getMap=function(){return s.empty},d.prototype.invert=function(t){return u()},d.prototype.map=function(t){return u()},d.prototype.merge=function(t){return null},d.prototype.toJSON=function(){return u()},d.fromJSON=function(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");var r=l[e.stepType];if(!r)throw new RangeError("No step type "+e.stepType+" defined");return r.fromJSON(t,e)},d.jsonID=function(t,e){if(t in l)throw new RangeError("Duplicate use of step JSON ID "+t);return l[t]=e,e.prototype.jsonID=t,e};var m=function(t,e){this.doc=t,this.failed=e};m.ok=function(t){return new m(t,null)},m.fail=function(t){return new m(null,t)},m.fromReplace=function(t,e,r,o){try{return m.ok(t.replace(e,r,o))}catch(t){if(t instanceof n.e4)return m.fail(t.message);throw t}};var v=function(t){function e(e,r,n,o){t.call(this),this.from=e,this.to=r,this.slice=n,this.structure=!!o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){return this.structure&&g(t,this.from,this.to)?m.fail("Structure replace would overwrite content"):m.fromReplace(t,this.from,this.to,this.slice)},e.prototype.getMap=function(){return new s([this.from,this.to-this.from,this.slice.size])},e.prototype.invert=function(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))},e.prototype.map=function(t){var r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deleted&&n.deleted?null:new e(r.pos,Math.max(r.pos,n.pos),this.slice)},e.prototype.merge=function(t){if(!(t instanceof e)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;var r=this.slice.size+t.slice.size==0?n.p2.empty:new n.p2(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,r,this.structure)}var o=this.slice.size+t.slice.size==0?n.p2.empty:new n.p2(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),o,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,r){if("number"!=typeof r.from||"number"!=typeof r.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(r.from,r.to,n.p2.fromJSON(t,r.slice),!!r.structure)},e}(d);d.jsonID("replace",v);var y=function(t){function e(e,r,n,o,i,p,s){t.call(this),this.from=e,this.to=r,this.gapFrom=n,this.gapTo=o,this.slice=i,this.insert=p,this.structure=!!s}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){if(this.structure&&(g(t,this.from,this.gapFrom)||g(t,this.gapTo,this.to)))return m.fail("Structure gap-replace would overwrite content");var e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return m.fail("Gap is not a flat range");var r=this.slice.insertAt(this.insert,e.content);return r?m.fromReplace(t,this.from,this.to,r):m.fail("Content does not fit in gap")},e.prototype.getMap=function(){return new s([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},e.prototype.invert=function(t){var r=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},e.prototype.map=function(t){var r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),o=t.map(this.gapFrom,-1),i=t.map(this.gapTo,1);return r.deleted&&n.deleted||o<r.pos||i>n.pos?null:new e(r.pos,n.pos,o,i,this.slice,this.insert,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,r){if("number"!=typeof r.from||"number"!=typeof r.to||"number"!=typeof r.gapFrom||"number"!=typeof r.gapTo||"number"!=typeof r.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(r.from,r.to,r.gapFrom,r.gapTo,n.p2.fromJSON(t,r.slice),r.insert,!!r.structure)},e}(d);function g(t,e,r){for(var n=t.resolve(e),o=r-e,i=n.depth;o>0&&i>0&&n.indexAfter(i)==n.node(i).childCount;)i--,o--;if(o>0)for(var p=n.node(i).maybeChild(n.indexAfter(i));o>0;){if(!p||p.isLeaf)return!0;p=p.firstChild,o--}return!1}function w(t,e,r){return(0==e||t.canReplace(e,t.childCount))&&(r==t.childCount||t.canReplace(0,r))}function k(t){for(var e=t.parent.content.cutByIndex(t.startIndex,t.endIndex),r=t.depth;;--r){var n=t.$from.node(r),o=t.$from.index(r),i=t.$to.indexAfter(r);if(r<t.depth&&n.canReplace(o,i,e))return r;if(0==r||n.type.spec.isolating||!w(n,o,i))break}}function S(t,e,r,n){void 0===n&&(n=t);var o=function(t,e){var r=t.parent,n=t.startIndex,o=t.endIndex,i=r.contentMatchAt(n).findWrapping(e);if(!i)return null;var p=i.length?i[0]:e;return r.canReplaceWith(n,o,p)?i:null}(t,e),i=o&&function(t,e){var r=t.parent,n=t.startIndex,o=t.endIndex,i=r.child(n),p=e.contentMatch.findWrapping(i.type);if(!p)return null;for(var s=(p.length?p[p.length-1]:e).contentMatch,a=n;s&&a<o;a++)s=s.matchType(r.child(a).type);return s&&s.validEnd?p:null}(n,e);return i?o.map(M).concat({type:e,attrs:r}).concat(i.map(M)):null}function M(t){return{type:t,attrs:null}}function C(t,e,r,n){void 0===r&&(r=1);var o=t.resolve(e),i=o.depth-r,p=n&&n[n.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!p.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var s=o.depth-1,a=r-2;s>i;s--,a--){var h=o.node(s),c=o.index(s);if(h.type.spec.isolating)return!1;var f=h.content.cutByIndex(c,h.childCount),u=n&&n[a]||h;if(u!=h&&(f=f.replaceChild(0,u.type.create(u.attrs))),!h.canReplace(c+1,h.childCount)||!u.type.validContent(f))return!1}var l=o.indexAfter(i),d=n&&n[0];return o.node(i).canReplaceWith(l,l,d?d.type:o.node(i+1).type)}function b(t,e){var r,n,o=t.resolve(e),i=o.index();return r=o.nodeBefore,n=o.nodeAfter,r&&n&&!r.isLeaf&&r.canAppend(n)&&o.parent.canReplace(i,i+1)}function x(t,e,r){var n=t.resolve(e);if(!r.content.size)return e;for(var o=r.content,i=0;i<r.openStart;i++)o=o.firstChild.content;for(var p=1;p<=(0==r.openStart&&r.size?2:1);p++)for(var s=n.depth;s>=0;s--){var a=s==n.depth?0:n.pos<=(n.start(s+1)+n.end(s+1))/2?-1:1,h=n.index(s)+(a>0?1:0),c=n.node(s),f=!1;if(1==p)f=c.canReplace(h,h,o);else{var u=c.contentMatchAt(h).findWrapping(o.firstChild.type);f=u&&c.canReplaceWith(h,h,u[0])}if(f)return 0==a?n.pos:a<0?n.before(s+1):n.after(s+1)}return null}function R(t,e,r){for(var o=[],i=0;i<t.childCount;i++){var p=t.child(i);p.content.size&&(p=p.copy(R(p.content,e,p))),p.isInline&&(p=e(p,r,i)),o.push(p)}return n.HY.fromArray(o)}d.jsonID("replaceAround",y),c.prototype.lift=function(t,e){for(var r=t.$from,o=t.$to,i=t.depth,p=r.before(i+1),s=o.after(i+1),a=p,h=s,c=n.HY.empty,f=0,u=i,l=!1;u>e;u--)l||r.index(u)>0?(l=!0,c=n.HY.from(r.node(u).copy(c)),f++):a--;for(var d=n.HY.empty,m=0,v=i,g=!1;v>e;v--)g||o.after(v+1)<o.end(v)?(g=!0,d=n.HY.from(o.node(v).copy(d)),m++):h++;return this.step(new y(a,h,p,s,new n.p2(c.append(d),f,m),c.size-f,!0))},c.prototype.wrap=function(t,e){for(var r=n.HY.empty,o=e.length-1;o>=0;o--)r=n.HY.from(e[o].type.create(e[o].attrs,r));var i=t.start,p=t.end;return this.step(new y(i,p,i,p,new n.p2(r,0,0),e.length,!0))},c.prototype.setBlockType=function(t,e,r,o){var i=this;if(void 0===e&&(e=t),!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var p=this.steps.length;return this.doc.nodesBetween(t,e,(function(t,e){if(t.isTextblock&&!t.hasMarkup(r,o)&&function(t,e,r){var n=t.resolve(e),o=n.index();return n.parent.canReplaceWith(o,o+1,r)}(i.doc,i.mapping.slice(p).map(e),r)){i.clearIncompatible(i.mapping.slice(p).map(e,1),r);var s=i.mapping.slice(p),a=s.map(e,1),h=s.map(e+t.nodeSize,1);return i.step(new y(a,h,a+1,h-1,new n.p2(n.HY.from(r.create(o,null,t.marks)),0,0),1,!0)),!1}})),this},c.prototype.setNodeMarkup=function(t,e,r,o){var i=this.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");e||(e=i.type);var p=e.create(r,null,o||i.marks);if(i.isLeaf)return this.replaceWith(t,t+i.nodeSize,p);if(!e.validContent(i.content))throw new RangeError("Invalid content for node type "+e.name);return this.step(new y(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new n.p2(n.HY.from(p),0,0),1,!0))},c.prototype.split=function(t,e,r){void 0===e&&(e=1);for(var o=this.doc.resolve(t),i=n.HY.empty,p=n.HY.empty,s=o.depth,a=o.depth-e,h=e-1;s>a;s--,h--){i=n.HY.from(o.node(s).copy(i));var c=r&&r[h];p=n.HY.from(c?c.type.create(c.attrs,p):o.node(s).copy(p))}return this.step(new v(t,t,new n.p2(i.append(p),e,e),!0))},c.prototype.join=function(t,e){void 0===e&&(e=1);var r=new v(t-e,t+e,n.p2.empty,!0);return this.step(r)};var N=function(t){function e(e,r,n){t.call(this),this.from=e,this.to=r,this.mark=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,r=t.slice(this.from,this.to),o=t.resolve(this.from),i=o.node(o.sharedDepth(this.to)),p=new n.p2(R(r.content,(function(t,r){return t.isAtom&&r.type.allowsMarkType(e.mark.type)?t.mark(e.mark.addToSet(t.marks)):t}),i),r.openStart,r.openEnd);return m.fromReplace(t,this.from,this.to,p)},e.prototype.invert=function(){return new O(this.from,this.to,this.mark)},e.prototype.map=function(t){var r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new e(r.pos,n.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,r){if("number"!=typeof r.from||"number"!=typeof r.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(r.from,r.to,t.markFromJSON(r.mark))},e}(d);d.jsonID("addMark",N);var O=function(t){function e(e,r,n){t.call(this),this.from=e,this.to=r,this.mark=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,r=t.slice(this.from,this.to),o=new n.p2(R(r.content,(function(t){return t.mark(e.mark.removeFromSet(t.marks))})),r.openStart,r.openEnd);return m.fromReplace(t,this.from,this.to,o)},e.prototype.invert=function(){return new N(this.from,this.to,this.mark)},e.prototype.map=function(t){var r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new e(r.pos,n.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,r){if("number"!=typeof r.from||"number"!=typeof r.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(r.from,r.to,t.markFromJSON(r.mark))},e}(d);function T(t,e,r){return!r.openStart&&!r.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),r.content)}d.jsonID("removeMark",O),c.prototype.addMark=function(t,e,r){var n=this,o=[],i=[],p=null,s=null;return this.doc.nodesBetween(t,e,(function(n,a,h){if(n.isInline){var c=n.marks;if(!r.isInSet(c)&&h.type.allowsMarkType(r.type)){for(var f=Math.max(a,t),u=Math.min(a+n.nodeSize,e),l=r.addToSet(c),d=0;d<c.length;d++)c[d].isInSet(l)||(p&&p.to==f&&p.mark.eq(c[d])?p.to=u:o.push(p=new O(f,u,c[d])));s&&s.to==f?s.to=u:i.push(s=new N(f,u,r))}}})),o.forEach((function(t){return n.step(t)})),i.forEach((function(t){return n.step(t)})),this},c.prototype.removeMark=function(t,e,r){var o=this;void 0===r&&(r=null);var i=[],p=0;return this.doc.nodesBetween(t,e,(function(o,s){if(o.isInline){p++;var a=null;if(r instanceof n.ZU)for(var h,c=o.marks;h=r.isInSet(c);)(a||(a=[])).push(h),c=h.removeFromSet(c);else r?r.isInSet(o.marks)&&(a=[r]):a=o.marks;if(a&&a.length)for(var f=Math.min(s+o.nodeSize,e),u=0;u<a.length;u++){for(var l=a[u],d=void 0,m=0;m<i.length;m++){var v=i[m];v.step==p-1&&l.eq(i[m].style)&&(d=v)}d?(d.to=f,d.step=p):i.push({style:l,from:Math.max(s,t),to:f,step:p})}}})),i.forEach((function(t){return o.step(new O(t.from,t.to,t.style))})),this},c.prototype.clearIncompatible=function(t,e,r){void 0===r&&(r=e.contentMatch);for(var o=this.doc.nodeAt(t),i=[],p=t+1,s=0;s<o.childCount;s++){var a=o.child(s),h=p+a.nodeSize,c=r.matchType(a.type,a.attrs);if(c){r=c;for(var f=0;f<a.marks.length;f++)e.allowsMarkType(a.marks[f].type)||this.step(new O(p,h,a.marks[f]))}else i.push(new v(p,h,n.p2.empty));p=h}if(!r.validEnd){var u=r.fillBefore(n.HY.empty,!0);this.replace(p,p,new n.p2(u,0,0))}for(var l=i.length-1;l>=0;l--)this.step(i[l]);return this},c.prototype.replace=function(t,e,r){void 0===e&&(e=t),void 0===r&&(r=n.p2.empty);var o=function(t,e,r,o){if(void 0===r&&(r=e),void 0===o&&(o=n.p2.empty),e==r&&!o.size)return null;var i=t.resolve(e),p=t.resolve(r);return T(i,p,o)?new v(e,r,o):new I(i,p,o).fit()}(this.doc,t,e,r);return o&&this.step(o),this},c.prototype.replaceWith=function(t,e,r){return this.replace(t,e,new n.p2(n.HY.from(r),0,0))},c.prototype.delete=function(t,e){return this.replace(t,e,n.p2.empty)},c.prototype.insert=function(t,e){return this.replaceWith(t,t,e)};var I=function(t,e,r){this.$to=e,this.$from=t,this.unplaced=r,this.frontier=[];for(var o=0;o<=t.depth;o++){var i=t.node(o);this.frontier.push({type:i.type,match:i.contentMatchAt(t.indexAfter(o))})}this.placed=n.HY.empty;for(var p=t.depth;p>0;p--)this.placed=n.HY.from(t.node(p).copy(this.placed))},z={depth:{configurable:!0}};function E(t,e,r){return 0==e?t.cutByIndex(r):t.replaceChild(0,t.firstChild.copy(E(t.firstChild.content,e-1,r)))}function _(t,e,r){return 0==e?t.append(r):t.replaceChild(t.childCount-1,t.lastChild.copy(_(t.lastChild.content,e-1,r)))}function F(t,e){for(var r=0;r<e;r++)t=t.firstChild.content;return t}function J(t,e,r){if(e<=0)return t;var o=t.content;return e>1&&(o=o.replaceChild(0,J(o.firstChild,e-1,1==o.childCount?r-1:0))),e>0&&(o=t.type.contentMatch.fillBefore(o).append(o),r<=0&&(o=o.append(t.type.contentMatch.matchFragment(o).fillBefore(n.HY.empty,!0)))),t.copy(o)}function A(t,e,r,n,o){var i=t.node(e),p=o?t.indexAfter(e):t.index(e);if(p==i.childCount&&!r.compatibleContent(i.type))return null;var s=n.fillBefore(i.content,!0,p);return s&&!function(t,e,r){for(var n=r;n<e.childCount;n++)if(!t.allowsMarks(e.child(n).marks))return!0;return!1}(r,i.content,p)?s:null}function H(t,e,r,o,i){if(e<r){var p=t.firstChild;t=t.replaceChild(0,p.copy(H(p.content,e+1,r,o,p)))}if(e>o){var s=i.contentMatchAt(0),a=s.fillBefore(t).append(t);t=a.append(s.matchFragment(a).fillBefore(n.HY.empty,!0))}return t}function Y(t,e){for(var r=[],n=Math.min(t.depth,e.depth);n>=0;n--){var o=t.start(n);if(o<t.pos-(t.depth-n)||e.end(n)>e.pos+(e.depth-n)||t.node(n).type.spec.isolating||e.node(n).type.spec.isolating)break;o==e.start(n)&&r.push(n)}return r}z.depth.get=function(){return this.frontier.length-1},I.prototype.fit=function(){for(;this.unplaced.size;){var t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}var e=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,o=this.$from,i=this.close(e<0?this.$to:o.doc.resolve(e));if(!i)return null;for(var p=this.placed,s=o.depth,a=i.depth;s&&a&&1==p.childCount;)p=p.firstChild.content,s--,a--;var h=new n.p2(p,s,a);return e>-1?new y(o.pos,e,this.$to.pos,this.$to.end(),h,r):h.size||o.pos!=this.$to.pos?new v(o.pos,i.pos,h):void 0},I.prototype.findFittable=function(){for(var t=1;t<=2;t++)for(var e=this.unplaced.openStart;e>=0;e--)for(var r=void 0,o=(e?(r=F(this.unplaced.content,e-1).firstChild).content:this.unplaced.content).firstChild,i=this.depth;i>=0;i--){var p=this.frontier[i],s=p.type,a=p.match,h=void 0,c=void 0;if(1==t&&(o?a.matchType(o.type)||(c=a.fillBefore(n.HY.from(o),!1)):s.compatibleContent(r.type)))return{sliceDepth:e,frontierDepth:i,parent:r,inject:c};if(2==t&&o&&(h=a.findWrapping(o.type)))return{sliceDepth:e,frontierDepth:i,parent:r,wrap:h};if(r&&a.matchType(r.type))break}},I.prototype.openMore=function(){var t=this.unplaced,e=t.content,r=t.openStart,o=t.openEnd,i=F(e,r);return!(!i.childCount||i.firstChild.isLeaf||(this.unplaced=new n.p2(e,r+1,Math.max(o,i.size+r>=e.size-o?r+1:0)),0))},I.prototype.dropNode=function(){var t=this.unplaced,e=t.content,r=t.openStart,o=t.openEnd,i=F(e,r);if(i.childCount<=1&&r>0){var p=e.size-r<=r+i.size;this.unplaced=new n.p2(E(e,r-1,1),r-1,p?r-1:o)}else this.unplaced=new n.p2(E(e,r,1),r,o)},I.prototype.placeNodes=function(t){for(var e=t.sliceDepth,r=t.frontierDepth,o=t.parent,i=t.inject,p=t.wrap;this.depth>r;)this.closeFrontierNode();if(p)for(var s=0;s<p.length;s++)this.openFrontierNode(p[s]);var a=this.unplaced,h=o?o.content:a.content,c=a.openStart-e,f=0,u=[],l=this.frontier[r],d=l.match,m=l.type;if(i){for(var v=0;v<i.childCount;v++)u.push(i.child(v));d=d.matchFragment(i)}for(var y=h.size+e-(a.content.size-a.openEnd);f<h.childCount;){var g=h.child(f),w=d.matchType(g.type);if(!w)break;(++f>1||0==c||g.content.size)&&(d=w,u.push(J(g.mark(m.allowedMarks(g.marks)),1==f?c:0,f==h.childCount?y:-1)))}var k=f==h.childCount;k||(y=-1),this.placed=_(this.placed,r,n.HY.from(u)),this.frontier[r].match=d,k&&y<0&&o&&o.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var S=0,M=h;S<y;S++){var C=M.lastChild;this.frontier.push({type:C.type,match:C.contentMatchAt(C.childCount)}),M=C.content}this.unplaced=k?0==e?n.p2.empty:new n.p2(E(a.content,e-1,1),e-1,y<0?a.openEnd:e-1):new n.p2(E(a.content,e,f),a.openStart,a.openEnd)},I.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var t,e=this.frontier[this.depth];if(!e.type.isTextblock||!A(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;for(var r=this.$to.depth,n=this.$to.after(r);r>1&&n==this.$to.end(--r);)++n;return n},I.prototype.findCloseLevel=function(t){t:for(var e=Math.min(this.depth,t.depth);e>=0;e--){var r=this.frontier[e],n=r.match,o=r.type,i=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),p=A(t,e,o,n,i);if(p){for(var s=e-1;s>=0;s--){var a=this.frontier[s],h=a.match,c=A(t,s,a.type,h,!0);if(!c||c.childCount)continue t}return{depth:e,fit:p,move:i?t.doc.resolve(t.after(e+1)):t}}}},I.prototype.close=function(t){var e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=_(this.placed,e.depth,e.fit)),t=e.move;for(var r=e.depth+1;r<=t.depth;r++){var n=t.node(r),o=n.type.contentMatch.fillBefore(n.content,!0,t.index(r));this.openFrontierNode(n.type,n.attrs,o)}return t},I.prototype.openFrontierNode=function(t,e,r){var o=this.frontier[this.depth];o.match=o.match.matchType(t),this.placed=_(this.placed,this.depth,n.HY.from(t.create(e,r))),this.frontier.push({type:t,match:t.contentMatch})},I.prototype.closeFrontierNode=function(){var t=this.frontier.pop().match.fillBefore(n.HY.empty,!0);t.childCount&&(this.placed=_(this.placed,this.frontier.length,t))},Object.defineProperties(I.prototype,z),c.prototype.replaceRange=function(t,e,r){if(!r.size)return this.deleteRange(t,e);var o=this.doc.resolve(t),i=this.doc.resolve(e);if(T(o,i,r))return this.step(new v(t,e,r));var p=Y(o,this.doc.resolve(e));0==p[p.length-1]&&p.pop();var s=-(o.depth+1);p.unshift(s);for(var a=o.depth,h=o.pos-1;a>0;a--,h--){var c=o.node(a).type.spec;if(c.defining||c.isolating)break;p.indexOf(a)>-1?s=a:o.before(a)==h&&p.splice(1,0,-a)}for(var f=p.indexOf(s),u=[],l=r.openStart,d=r.content,m=0;;m++){var y=d.firstChild;if(u.push(y),m==r.openStart)break;d=y.content}l>0&&u[l-1].type.spec.defining&&o.node(f).type!=u[l-1].type?l-=1:l>=2&&u[l-1].isTextblock&&u[l-2].type.spec.defining&&o.node(f).type!=u[l-2].type&&(l-=2);for(var g=r.openStart;g>=0;g--){var w=(g+l+1)%(r.openStart+1),k=u[w];if(k)for(var S=0;S<p.length;S++){var M=p[(S+f)%p.length],C=!0;M<0&&(C=!1,M=-M);var b=o.node(M-1),x=o.index(M-1);if(b.canReplaceWith(x,x,k.type,k.marks))return this.replace(o.before(M),C?i.after(M):e,new n.p2(H(r.content,0,r.openStart,w),w,r.openEnd))}}for(var R=this.steps.length,N=p.length-1;N>=0&&(this.replace(t,e,r),!(this.steps.length>R));N--){var O=p[N];O<0||(t=o.before(O),e=i.after(O))}return this},c.prototype.replaceRangeWith=function(t,e,r){if(!r.isInline&&t==e&&this.doc.resolve(t).parent.content.size){var o=function(t,e,r){var n=t.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),r))return e;if(0==n.parentOffset)for(var o=n.depth-1;o>=0;o--){var i=n.index(o);if(n.node(o).canReplaceWith(i,i,r))return n.before(o+1);if(i>0)return null}if(n.parentOffset==n.parent.content.size)for(var p=n.depth-1;p>=0;p--){var s=n.indexAfter(p);if(n.node(p).canReplaceWith(s,s,r))return n.after(p+1);if(s<n.node(p).childCount)return null}}(this.doc,t,r.type);null!=o&&(t=e=o)}return this.replaceRange(t,e,new n.p2(n.HY.from(r),0,0))},c.prototype.deleteRange=function(t,e){for(var r=this.doc.resolve(t),n=this.doc.resolve(e),o=Y(r,n),i=0;i<o.length;i++){var p=o[i],s=i==o.length-1;if(s&&0==p||r.node(p).type.contentMatch.validEnd)return this.delete(r.start(p),n.end(p));if(p>0&&(s||r.node(p-1).canReplace(r.index(p-1),n.indexAfter(p-1))))return this.delete(r.before(p),n.after(p))}for(var a=1;a<=r.depth&&a<=n.depth;a++)if(t-r.start(a)==r.depth-a&&e>r.end(a)&&n.end(a)-e!=n.depth-a)return this.delete(r.before(a),e);return this.delete(t,e)}}}]);