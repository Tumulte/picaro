(self.webpackChunkjavascript_development_environment=self.webpackChunkjavascript_development_environment||[]).push([[838],{7446:(e,t,n)=>{"use strict";n.d(t,{m8:()=>w,KX:()=>M,Yw:()=>y});var r=n(9464),i=n(1081),s=n(6922),p=function(e,t){this.items=e,this.eventCount=t};p.prototype.popEvent=function(e,t){var n=this;if(0==this.eventCount)return null;for(var r,i,s=this.items.length;;s--)if(this.items.get(s-1).selection){--s;break}t&&(r=this.remapping(s,this.items.length),i=r.maps.length);var o,u,m=e.tr,l=[],h=[];return this.items.forEach((function(e,t){if(!e.step)return r||(r=n.remapping(s,t+1),i=r.maps.length),i--,void h.push(e);if(r){h.push(new a(e.map));var f,c=e.step.map(r.slice(i));c&&m.maybeStep(c).doc&&(f=m.mapping.maps[m.mapping.maps.length-1],l.push(new a(f,null,null,l.length+h.length))),i--,f&&r.appendMap(f,i)}else m.maybeStep(e.step);return e.selection?(o=r?e.selection.map(r.slice(i)):e.selection,u=new p(n.items.slice(0,s).append(h.reverse().concat(l)),n.eventCount-1),!1):void 0}),this.items.length,0),{remaining:u,transform:m,selection:o}},p.prototype.addTransform=function(e,t,n,r){for(var i=[],s=this.eventCount,o=this.items,m=!r&&o.length?o.get(o.length-1):null,l=0;l<e.steps.length;l++){var h,f=e.steps[l].invert(e.docs[l]),c=new a(e.mapping.maps[l],f,t);(h=m&&m.merge(c))&&(c=h,l?i.pop():o=o.slice(0,o.length-1)),i.push(c),t&&(s++,t=null),r||(m=c)}var v,g,d,w=s-n.depth;return w>u&&(g=w,(v=o).forEach((function(e,t){if(e.selection&&0==g--)return d=t,!1})),o=v.slice(d),s-=w),new p(o.append(i),s)},p.prototype.remapping=function(e,t){var n=new i.vs;return this.items.forEach((function(t,r){var i=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:null;n.appendMap(t.map,i)}),e,t),n},p.prototype.addMaps=function(e){return 0==this.eventCount?this:new p(this.items.append(e.map((function(e){return new a(e)}))),this.eventCount)},p.prototype.rebased=function(e,t){if(!this.eventCount)return this;var n=[],r=Math.max(0,this.items.length-t),i=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach((function(e){e.selection&&o--}),r);var u=t;this.items.forEach((function(t){var r=i.getMirror(--u);if(null!=r){s=Math.min(s,r);var p=i.maps[r];if(t.step){var m=e.steps[r].invert(e.docs[r]),l=t.selection&&t.selection.map(i.slice(u+1,r));l&&o++,n.push(new a(p,m,l))}else n.push(new a(p))}}),r);for(var m=[],l=t;l<s;l++)m.push(new a(i.maps[l]));var h=this.items.slice(0,r).append(m).append(n),f=new p(h,o);return f.emptyItemCount()>500&&(f=f.compress(this.items.length-n.length)),f},p.prototype.emptyItemCount=function(){var e=0;return this.items.forEach((function(t){t.step||e++})),e},p.prototype.compress=function(e){void 0===e&&(e=this.items.length);var t=this.remapping(0,e),n=t.maps.length,i=[],s=0;return this.items.forEach((function(r,p){if(p>=e)i.push(r),r.selection&&s++;else if(r.step){var o=r.step.map(t.slice(n)),u=o&&o.getMap();if(n--,u&&t.appendMap(u,n),o){var m=r.selection&&r.selection.map(t.slice(n));m&&s++;var l,h=new a(u.invert(),o,m),f=i.length-1;(l=i.length&&i[f].merge(h))?i[f]=l:i.push(h)}}else r.map&&n--}),this.items.length,0),new p(r.Z.from(i.reverse()),s)},p.empty=new p(r.Z.empty,0);var a=function(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r};a.prototype.merge=function(e){if(this.step&&e.step&&!e.selection){var t=e.step.merge(this.step);if(t)return new a(t.getMap().invert(),t,this.selection)}};var o=function(e,t,n,r){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r},u=20;function m(e){var t=[];return e.forEach((function(e,n,r,i){return t.push(r,i)})),t}function l(e,t){if(!e)return null;for(var n=[],r=0;r<e.length;r+=2){var i=t.map(e[r],1),s=t.map(e[r+1],-1);i<=s&&n.push(i,s)}return n}function h(e,t,n,r){var i=v(t),s=g.get(t).spec.config,p=(r?e.undone:e.done).popEvent(t,i);if(p){var a=p.selection.resolve(p.transform.doc),u=(r?e.done:e.undone).addTransform(p.transform,t.selection.getBookmark(),s,i),m=new o(r?u:p.remaining,r?p.remaining:u,null,0);n(p.transform.setSelection(a).setMeta(g,{redo:r,historyState:m}).scrollIntoView())}}var f=!1,c=null;function v(e){var t=e.plugins;if(c!=t){f=!1,c=t;for(var n=0;n<t.length;n++)if(t[n].spec.historyPreserveItems){f=!0;break}}return f}var g=new s.H$("history"),d=new s.H$("closeHistory");function w(e){return e={depth:e&&e.depth||100,newGroupDelay:e&&e.newGroupDelay||500},new s.Sy({key:g,state:{init:function(){return new o(p.empty,p.empty,null,0)},apply:function(t,n,r){return function(e,t,n,r){var i,s=n.getMeta(g);if(s)return s.historyState;n.getMeta(d)&&(e=new o(e.done,e.undone,null,0));var a=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(a&&a.getMeta(g))return a.getMeta(g).redo?new o(e.done.addTransform(n,null,r,v(t)),e.undone,m(n.mapping.maps[n.steps.length-1]),e.prevTime):new o(e.done,e.undone.addTransform(n,null,r,v(t)),null,e.prevTime);if(!1===n.getMeta("addToHistory")||a&&!1===a.getMeta("addToHistory"))return(i=n.getMeta("rebased"))?new o(e.done.rebased(n,i),e.undone.rebased(n,i),l(e.prevRanges,n.mapping),e.prevTime):new o(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),l(e.prevRanges,n.mapping),e.prevTime);var u=0==e.prevTime||!a&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;var n=!1;return e.mapping.maps[0].forEach((function(e,r){for(var i=0;i<t.length;i+=2)e<=t[i+1]&&r>=t[i]&&(n=!0)})),n}(n,e.prevRanges)),h=a?l(e.prevRanges,n.mapping):m(n.mapping.maps[n.steps.length-1]);return new o(e.done.addTransform(n,u?t.selection.getBookmark():null,r,v(t)),p.empty,h,n.time)}(n,r,t,e)}},config:e,props:{handleDOMEvents:{beforeinput:function(e,t){var n="historyUndo"==t.inputType?y(e.state,e.dispatch):"historyRedo"==t.inputType&&M(e.state,e.dispatch);return n&&t.preventDefault(),n}}}})}function y(e,t){var n=g.getState(e);return!(!n||0==n.done.eventCount||(t&&h(n,e,t,!1),0))}function M(e,t){var n=g.getState(e);return!(!n||0==n.undone.eventCount||(t&&h(n,e,t,!0),0))}}}]);